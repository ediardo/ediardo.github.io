{{- $images := split (.Get "images") "," -}}
<div class="carousel">
  {{- range $i, $img := $images -}}
  {{- $src := strings.TrimSpace $img -}}
  {{- with resources.Get $src -}}
  {{- $resized := .Resize "1600x" -}}
  <div class="carousel-slide{{ if eq $i 0 }} active{{ end }}">
    <img src="{{ $resized.RelPermalink }}" width="{{ $resized.Width }}" height="{{ $resized.Height }}" alt="" loading="lazy" class="carousel-img">
  </div>
  {{- end -}}
  {{- end -}}
  <button class="carousel-btn carousel-prev" aria-label="Previous">&#10094;</button>
  <button class="carousel-btn carousel-next" aria-label="Next">&#10095;</button>
  <div class="carousel-dots"></div>
</div>
<style>
  .carousel {
    position: relative;
    width: 100%;
    overflow: hidden;
  }
  .carousel-slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    opacity: 0;
    transition: opacity 0.8s ease-in-out;
  }
  .carousel-slide.active {
    position: relative;
    opacity: 1;
  }
  .carousel-img {
    width: 100%;
    height: auto;
    display: block;
  }
  .carousel-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0,0,0,0.4);
    color: #fff;
    border: none;
    padding: 0.75rem 1rem;
    cursor: pointer;
    font-size: 1.25rem;
    z-index: 10;
  }
  .carousel-prev { left: 0.5rem; }
  .carousel-next { right: 0.5rem; }
  .carousel-btn:hover { background: rgba(0,0,0,0.7); }
  .carousel-dots {
    position: absolute;
    bottom: 1rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 0.5rem;
    z-index: 10;
  }
  .carousel-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: rgba(255,255,255,0.5);
    cursor: pointer;
    border: none;
  }
  .carousel-dot.active { background: #fff; }
</style>
<script>
(function() {
  var slides = document.querySelectorAll('.carousel-slide');
  var dotsContainer = document.querySelector('.carousel-dots');
  var prevBtn = document.querySelector('.carousel-prev');
  var nextBtn = document.querySelector('.carousel-next');
  var current = 0;
  var total = slides.length;
  var timer = null;

  for (var i = 0; i < total; i++) {
    (function(idx) {
      var dot = document.createElement('button');
      dot.className = 'carousel-dot' + (idx === 0 ? ' active' : '');
      dot.addEventListener('click', function() { goTo(idx, true); });
      dotsContainer.appendChild(dot);
    })(i);
  }
  var dots = dotsContainer.querySelectorAll('.carousel-dot');

  function goTo(idx, resetTimer) {
    slides[current].classList.remove('active');
    dots[current].classList.remove('active');
    current = (idx + total) % total;
    slides[current].classList.add('active');
    dots[current].classList.add('active');
    if (resetTimer) {
      clearInterval(timer);
      timer = setInterval(function() { goTo(current + 1, false); }, 5000);
    }
  }

  prevBtn.addEventListener('click', function() { goTo(current - 1, true); });
  nextBtn.addEventListener('click', function() { goTo(current + 1, true); });

  timer = setInterval(function() { goTo(current + 1, false); }, 5000);
})();
</script>
